---
import { ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, PieChart, Pie, Cell, Legend } from 'recharts';
const { dailyData = [], balanceData = [] } = Astro.props;

function formatFr(value) {
  if (typeof value !== 'number') return value;
  return value
    .toLocaleString('fr-FR', { minimumFractionDigits: 2 })
    .replace('.', ',');
}
---

<div style="display: flex; flex-direction: column; gap: 40px;">
  <!-- Graphique 1 -->
  <div class="card">
    <h3 style="color:#667eea; margin-bottom:15px;">☀️ Production solaire du jour</h3>
    <ResponsiveContainer width="100%" height={300}>
      <LineChart data={dailyData}>
        <defs>
          <linearGradient id="gradEnergy" x1="0" y1="0" x2="0" y2="1">
            <stop offset="5%" stopColor="#667eea" stopOpacity={0.8}/>
            <stop offset="95%" stopColor="#667eea" stopOpacity={0.1}/>
          </linearGradient>
        </defs>
        <CartesianGrid strokeDasharray="3 3" stroke="#ddd" />
        <XAxis dataKey="time" />
        <YAxis tickFormatter={(v) => v.toLocaleString('fr-FR')} />
        <Tooltip formatter={(v) => `${formatFr(v)} kWh`} />
        <Line type="monotone" dataKey="production" stroke="#667eea" strokeWidth={3} fill="url(#gradEnergy)" dot={false} />
      </LineChart>
    </ResponsiveContainer>
  </div>

  <!-- Graphique 2 -->
  <div class="card">
    <h3 style="color:#667eea; margin-bottom:15px;">⚡ Répartition énergétique</h3>
    <ResponsiveContainer width="100%" height={300}>
      <PieChart>
        <Pie
          dataKey="value"
          data={balanceData}
          cx="50%"
          cy="50%"
          outerRadius={100}
          label={({ name, value }) => `${name} : ${formatFr(value)} kWh`}
        >
          <Cell fill="#22c55e" />
          <Cell fill="#facc15" />
          <Cell fill="#3b82f6" />
        </Pie>
        <Tooltip formatter={(v) => `${formatFr(v)} kWh`} />
        <Legend />
      </PieChart>
    </ResponsiveContainer>
  </div>
</div>
