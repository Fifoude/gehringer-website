---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import "../../styles/solar.css";
import { getLangFromUrl } from "../../i18n/utils";
const lang = getLangFromUrl(Astro.url);
---

<Layout title="Solar Dashboard - Production">
    <Header slot="header" />

    <div class="solar-container" data-lang={lang}>
        <div class="card">
            <h1>☀️ Solar Dashboard</h1>

            <div class="alert">
                <div class="alert-title">ℹ️ Information</div>
                <p>Switch between tabs to explore different analyses.</p>
            </div>

            <div id="globalLoading" class="loading">⏳ Loading data...</div>
            <div id="error" class="error"></div>
            <div id="success" class="success"></div>
        </div>

        <div id="dataSection" class="data-section card">
            <div class="tabs">
                <div class="tab active" data-tab="production">
                    Production & Forecasts
                </div>
                <div class="tab" data-tab="energy">Energy Flows</div>
                <div class="tab" data-tab="balance">Monthly Performance</div>
                <div class="tab" data-tab="solar">Historical Accuracy</div>
            </div>

            <div id="productionTab" class="tab-content active">
                <h2>Today's Production & Forecasts</h2>
                <div class="stats-container">
                    <div id="productionTotal" class="stat-card">
                        <div class="stat-label">Total Production</div>
                        <div class="stat-value">-- kWh</div>
                    </div>
                    <div id="forecastTotal" class="stat-card">
                        <div class="stat-label">Total Forecast</div>
                        <div class="stat-value">-- kWh</div>
                    </div>
                </div>
                <div id="chartContainer" class="chart-container">
                    <canvas id="productionChart"></canvas>
                </div>
                <div id="chartTimestamp" class="timestamp"></div>
            </div>

            <div id="energyTab" class="tab-content">
                <h2>Today's Energy Flows</h2>
                <div class="stats-container">
                    <div id="energyProductionTotal" class="stat-card">
                        <div class="stat-label">Total Production</div>
                        <div class="stat-value">-- kWh</div>
                    </div>
                    <div id="energyConsumptionTotal" class="stat-card">
                        <div class="stat-label">Total Consumption</div>
                        <div class="stat-value">-- kWh</div>
                    </div>
                    <div id="energyNetGridTotal" class="stat-card">
                        <div class="stat-label">Grid Flow</div>
                        <div class="stat-value">-- kWh</div>
                    </div>
                </div>
                <div class="chart-container chart-with-y-labels">
                    <div class="y-axis-label y-axis-top">Production</div>
                    <div class="y-axis-label y-axis-middle">kWh</div>
                    <div class="y-axis-label y-axis-bottom">Consumption</div>
                    <canvas id="energyChart"></canvas>
                </div>
            </div>

            <div id="balanceTab" class="tab-content">
                <h2>Monthly Performance</h2>
                <div class="chart-container">
                    <canvas id="balanceChart"></canvas>
                </div>
            </div>

            <div id="solarTab" class="tab-content">
                <h2>Historical Accuracy</h2>
                <div class="chart-container">
                    <canvas id="solarChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <Footer slot="footer" />

    <script>
        import "../../scripts/solar-charts.js";
    </script>
</Layout>
